The RF Index tool is designed to automatically generate a Bowtie reference index, that will be used by the RF Map module for reads mapping.<br />This tool requires an internet connection, since it relies on querying the UCSC Genome database to obtain transcripts annotation and reference genome’s sequence. Alternatively, RF Index can be used to retrieve prebuilt indexes from RNAFramework.com.<br /><br />

# Usage
To list the required parameters, simply type:

```bash
$ rf-index -h
```

Parameter         | Type | Description
----------------: | :--: |:------------
__-b2__ *or* __--bowtie2__ | | Generates/retrieves a Bowtie v2 index (Default: __Bowtie v1__)
__-o__ *or* __--output-dir__ | string | Bowtie index output directory (Default: __automatically defined__ in index retrieval mode, __&lt;assembly&gt;\_&lt;annotation&gt;\_&lt;bowtie version&gt;__ in index building mode)
__-ow__ *or* __--overwrite__ | | Overwrites the output directory if already exists
 | | __Prebuilt indexes retrieval mode__
__-l__ *or* __--list__ | | Lists available RNA Framework prebuilt reference indexes
__-pb__ *or* __--prebuilt__ | int | Retrieves the prebuilt reference index with the given ID (>=1, Default: none)<br/>__Note:__ to obtain a list of available prebuild indexes, use ``-l`` (or ``--list``)
 | | __Reference building mode__
__-g__ *or* __--genome-assembly__ | string |Genome assembly for the species of interest (Default: __mm9__).<br /> For a complete list of UCSC available assemblies, please refer to the UCSC website (<https://genome.ucsc.edu/FAQ/FAQreleases.html>)
__-a__ *or* __--annotation__ | string | Name of the UCSC table containing the genes annotation (Default: __refFlat__).<br />For a complete list of tables available for the chosen assembly, please refer to the UCSC website (<https://genome.ucsc.edu/cgi-bin/hgTables>)
__-n__ *or* __--alt-name__ | | Uses alternative gene names (see UCSC tables' "__name2__" column)
__-co__ *or* __--coding-only__ | | Builds reference index using only protein-coding transcripts
__-no__ *or* __--noncoding-only__ | | Builds reference index using only non-coding transcripts
__-t__ *or* __--timeout__ | int | Connection’s timeout in seconds (Default: __180__)
__-r__ *or* __--reference__ | string | Path to a FASTA file containing chromosome (or scaffold) sequences for the chosen genome assembly.<br/>__Note:__ if no file is specified, RF Index will try to obtain sequences from the UCSC DAS server. This process may take up to hours, depending on your connection's speed.
__-b__ *or* __--bowtie-build__ | string | Path to ``bowtie-build`` (or ``bowtie2-build``) executable (Default: assumes ``bowtie-build``/``bowtie2-build`` is in PATH)
__-e__ *or* __--bedtools__ | string | Path to ``bedtools`` executable (Default: assumes ``bedtools`` is in PATH)

!!! note "Note"
    For experiments conducted over synthetic RNAs (or custom RNA pools), a reference can be generated by directly invoking the ``bowtie-build`` command on a FASTA file lexicographically sorted by sequence ID.

To prepare a custom Bowtie index, simply do:

```bash
# Sort reference FASTA file by sequence ID
$ awk 'BEGIN{RS=">"} NR>1 {gsub("\n", "\t"); print ">"$0}' reference_unsorted.fa | \ 
  LC_ALL=C sort -t ' ' -k 2,2 | \ 
  awk '{sub("\t", "\n"); gsub("\t", ""); print $0}' > reference_sorted.fa

# Build a Bowtie index
$ bowtie-build reference_sorted.fa reference_sorted

# Alternatively, build a Bowtie v2 index
$ bowtie2-build reference_sorted.fa reference_sorted

$ ls -l

  -rwxrwxrwx 1 danny epigenetics  96041105 5 mar 10.50 reference_sorted.1.ebwt  -rwxrwxrwx 1 danny epigenetics  37313744 5 mar 10.50 reference_sorted.2.ebwt  -rwxrwxrwx 1 danny epigenetics   1844468 5 mar 10.28 reference_sorted.3.ebwt  -rwxrwxrwx 1 danny epigenetics  74627475 5 mar 10.28 reference_sorted.4.ebwt  -rwxrwxrwx 1 danny epigenetics 302198817 5 mar 10.28 reference_sorted.fa  -rwxrwxrwx 1 danny epigenetics  96041105 5 mar 11.11 reference_sorted.rev.1.ebwt  -rwxrwxrwx 1 danny epigenetics  37313744 5 mar 11.11 reference_sorted.rev.2.ebwt  -rwxrwxrwx 1 danny epigenetics 302198817 5 mar 10.28 reference_unsorted.fa
```