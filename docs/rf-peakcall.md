The RF PeakCall module takes two RC files generated by the RF Count module, and performs transcriptome-wide peak calling from RNA immunoprecipitation (IP) experiments.<br/>
Analysis is performed by sliding a window of length *w* along the transcript, and calculating the signal enrichment in the IP sample versus control sample as:<br/>

<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>E</mi><mrow><mo>(</mo><mi>i</mi><mo>.</mo><mo>.</mo><mi>i</mi><mo>+</mo><mi>w</mi><mo>)</mo></mrow></msub><mo>=</mo><msub><mi>log</mi><mrow><mo>2</mo></mrow></msub><mfenced><mfrac><mstyle displaystyle="true"><mfrac bevelled="true"><mfenced><mrow><msub><mi>&#x3BC;</mi><mrow><mi>I</mi><mi>P</mi><mo>(</mo><mi>i</mi><mo>.</mo><mo>.</mo><mi>i</mi><mo>+</mo><mi>w</mi><mo>)</mo></mrow></msub><mo>+</mo><mi>p</mi></mrow></mfenced><mfenced><mrow><mi>M</mi><msub><mi>d</mi><mrow><mi>I</mi><mi>P</mi></mrow></msub><mo>+</mo><mi>p</mi></mrow></mfenced></mfrac></mstyle><mstyle displaystyle="true"><mfrac bevelled="true"><mfenced><mrow><msub><mi>&#x3BC;</mi><mrow><mi>C</mi><mi>t</mi><mi>r</mi><mi>l</mi><mo>(</mo><mi>i</mi><mo>.</mo><mo>.</mo><mi>i</mi><mo>+</mo><mi>w</mi><mo>)</mo></mrow></msub><mo>+</mo><mi>p</mi></mrow></mfenced><mfenced><mrow><mi>M</mi><msub><mi>d</mi><mrow><mi>C</mi><mi>t</mi><mi>r</mi><mi>l</mi></mrow></msub><mo>+</mo><mi>p</mi></mrow></mfenced></mfrac></mstyle></mfrac></mfenced></math>
<br/>
where *i* and *i+w* are the start and end position of the window, *&#x3BC;<sub>IP(i..i+w)</sub>* and *&#x3BC;<sub>Ctrl(i..i+w)</sub>* are respectively the mean coverage within the analyzed window in the IP and control samples, *Md<sub>IP</sub>* and *Md<sub>Ctrl</sub>* are respectively the median coverage on the whole transcript in the IP and control samples, and *p* is a pseudocount added to deal with non-covered regions/transcripts.<br/>

A p-value is then calculated for each window with detected enrichment above a defined cutoff, using a __Fisher's exact test__. Thus, the following 2x2 contingency matrix is defined for each cutoff-passing window:<br/>

 &nbsp; | Mean | Median
-------------: | :------------:  | :------------:
__IP__ | *&#x3BC;<sub>IP(i..i+w)</sub>* | *Md<sub>IP</sub>*
__Control__ | *&#x3BC;<sub>Ctrl(i..i+w)</sub>* | *Md<sub>Ctrl</sub>*

P-values are then subjected to Benjamini-Hochberg correction. Consecutive significantly enriched windows are then merged together, and p-values are combined using Stouffer's method.<br/>

# Usage
To list the required parameters, simply type:

```bash
$ rf-peakcall -h
```

Parameter         | Type | Description
----------------: | :--: |:------------
__-c__ *or* __--control__ | string | Path to the RC file for the control sample
__-I__ *or* __--IP__ | string | Path to the RC file for the immunoprecipitated (IP) sample
__-i__ *or* __--index__ | string[,string] | A comma separated (no spaces) list of RCI index files for the provided RC files<br/>__Note #1:__ RCI files must be provided in the order 1. Control, 2. IP<br/>__Note #2:__ If a single RTI file is specified, it will be used for all RC files<br/>__Note #3:__ If no RCI index is provided, it will be generated at runtime, and stored in the same folder of the control/IP samples
__-p__ *or* __--processors__ | int | Number of processors (threads) to use (Default: __1__)
__-o__ *or* __--output__ | string | Output peaks BED-like file (Default: __&lt;IP&gt;\_vs\_&lt;Control&gt;.bed/__)
__-ow__ *or* __--overwrite__ | | Overwrites the output file if already exists
__-w__ *or* __--window__ | int | Window size (in nt) for peak calling (&ge;10, Default: __150__)
__-f__ *or* __--offset__ | int | Offset (in nt) for window sliding (&ge;1, Default: __window / 2__)
__-md__ *or* __--merge-distance__ | int | Maximum distance (in nt) for merging non-overlapping windows (&ge;0, Default: __50__)
__-e__ *or* __--enrichment__ | float | Minimum log<sub>2</sub> enrichment in IP vs. Control for reporting a peak (&ge;1, Default: __3__)
__-v__ *or* __--p-value__ | float | P-value cutoff for reporting a peak (0 &le; *p* &le; 1, Default: __0.05__)
__-pc__ *or* __--pseudocount__ | float | Pseudocount added to read counts to avoid division by 0 (&gt;0, Default: __1__)
__-mc__ *or* __--mean-coverage__ | float | Discards any transcript with mean coverage below this threshold (&ge;0, Default: __0__)
__-ec__ *or* __--median-coverage__ | float | Discards any transcript with median coverage below this threshold (&ge;0, Default: __0__)
__-D__ *or* __--decimals__ | int | Number of decimals for reporting enrichment/p-value (1-10, Default: __3__)